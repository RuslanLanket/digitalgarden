---
{"dg-publish":true,"permalink":"/proekt-ii-assitent/baza-dannyh-struktura/variant2-bazy-dannyh/","tags":["бд","бот","ии","ии-ассистенты","бот-продавец","bd","иипроект","чат-боты"]}
---

## Этот вариант мне больше нравиться

Таблица TgClients хранения id телеграммов и состояний

| id                               | idTelegramm           | state                                            | dt                                    | dialog                |
| -------------------------------- | --------------------- | ------------------------------------------------ | ------------------------------------- | --------------------- |
| DataType:bigint<br>Type:identity | DataType:bigint       | DataType:smallint                                | DataType:timestamp                    | DataType:text         |
| id записи для связки запросов    | id телеграмма клиента | 1 диалог (по умолчанию)<br>2 клиент<br>3 воронка | Дата со временем последнего сообщения | Текст всего диалога*1 |

> \*1 После каждого получения сообщения клиента идёт обработка через ИИ ассистента. Далее текст сообщения клиента  + ответ ассистента соединяются в единый текст и добавляются в существующий текстданного поля. Таким образом в конце диалога бота с клиентом мы получаем в данном поле полный текст (все сообщения) диалога бота с клиентом. Естественно надо добавлять в начале каждого блока сообщения от кого данное сообщение. 

> Данный вариант более подходит для текущей задачи. И в принцепе не ломает дальнейшие планы

